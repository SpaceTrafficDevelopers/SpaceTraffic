@using System;
@using System.Collections.ObjectModel;
    
@{
    ViewBag.Title = "_Overview";
    SpaceTraffic.GameUi.GameServerClient.IGameServerClient Client = SpaceTraffic.GameUi.GameServerClient.GameServerClientFactory.GetClientInstance();
    SpaceTraffic.Entities.Player player = Client.GameService.GetPlayerByName(Context.User.Identity.Name);
    SpaceTraffic.Game.Land land = null;
    //Creates a dummy land if there isn't one created in this base 
    if (!(player.Lands != null)) { land = new SpaceTraffic.Game.Land(); }
    else
    {
        foreach (SpaceTraffic.Game.Land temp in player.Lands)
        {
            if (temp.LandDAO.BaseId == player.currentBase.BaseId) { land = temp; }
        }
    }
    int tilesOwned = 0;
    int warTiles = 0;
    int facTiles = 0;
    int docTiles = 0;
    int freeTiles = 0;
    foreach (SpaceTraffic.Entities.Tile tile in land.LandDAO.Tiles) { tilesOwned += tile.purchased ? 1 : 0; }
    freeTiles = tilesOwned;
    foreach (SpaceTraffic.Game.Building build in land.LandDAO.Buildings)
    {
        SpaceTraffic.Entities.Building building = build.BuildingDAO;
        if (building.Type == "Warehouse") { warTiles += building.Size[0] * building.Size[1]; }
        else if (building.Type == "Factory") { facTiles += building.Size[0] * building.Size[1]; }
        else { docTiles+= building.Size[0] * building.Size[1]; }
        freeTiles -= building.Size[0] * building.Size[1];
    }
}
    
<table class="summarytable">
<tr><th>Tiles owned:</th><td>@tilesOwned</td></tr>
<tr><th>Warehouse tiles:</th><td>@warTiles</td></tr>
<tr><th>Factory tiles:</th><td>@facTiles</td></tr>
<tr><th>Dock tiles:</th><td>@docTiles</td></tr>
<tr><th>Free tiles:</th><td>@freeTiles</td></tr>
</table>
<br />
<table class="itemtable shipsview">
<thead>
<tr><th>Icon</th><th>Type</th><th>Name</th><th colspan="3">Size</th></tr>
</thead>
<tbody>
        @foreach (SpaceTraffic.Game.Building build in land.LandDAO.Buildings)
        {
        <tr>
            <td>
                @{
            string url = "";
            if (build.BuildingDAO.Type == "Factory") { url = "~/Content/images/placeholderFactory.png"; }
            else { url = build.BuildingDAO.Type == "Warehouse" ? "~/Content/images/placeholder.png" : "~/Content/images/ships_button_icon.png"; }
                }
                <img src="@(Url.Content(url))" width="32" height="32" alt="" />
            </td>
            <td>@build.BuildingDAO.Type</td>
            @{String temp = build.BuildingDAO.Type + " at " + build.BuildingDAO.Location[0] + ", " + build.BuildingDAO.Location[1];}
            <td>@temp</td>
            <td>@build.BuildingDAO.Size[0]</td>
            <td>x</td>
            <td>@build.BuildingDAO.Size[1]</td>
        </tr>
        }
</tbody>
</table>

